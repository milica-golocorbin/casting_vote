# CastingVote - Phoenix(1.6) fullstack project.

## Project creation

```
mix phx.new casting_vote --binary-id
```

## Adding Credo, Mix test.watch, ExCoveralls

We will use credo for static code analyses and code consistency. It is a great tool for following standards and best practices of elixir.

Mix test.watch is great for automatically running our tests. So we don't have to constantly call mix.test, whenever we test something.

We will use ExCoveralls as a test coverage tool. It will show us how many percent of our code is covered by tests.

**mix.exs**

```
# Add it to your dependencies:

...
{:credo, "~> 1.6", only: [:dev, :test], runtime: false},
{:mix_test_watch, "~> 1.0", only: [:dev, :test], runtime: false},
{:excoveralls, "~> 0.10", only: :test}

# Add the following parameters into project:

  def project do
    [
      ...
      test_coverage: [tool: ExCoveralls],
      preferred_cli_env: [
        "test.watch": :test,
        coveralls: :test,
        "coveralls.detail": :test,
        "coveralls.post": :test,
        "coveralls.html": :test
      ]
    ]
  end
```

```
# Fetch dependencies:
  mix deps.get
```

**credo**

```
# Run task:
  mix credo -a --strict
```

- Modules should have a @moduledoc tag.

Either go into modules and add documentation or add: @moduledoc false

- Nested modules could be aliased at the top of the invoking module.

Add: alias Ecto.Adapters.SQL.Sandbox on top

**mix test.watch**

```
# Run task:
mix test.watch
```

**coveralls**

```
# Run task:
  MIX_ENV=test mix coveralls

# Run task to generate html:
  mix coveralls.html
```

Add files you want to be skipped during code coverage calculation. Files autogenerated by Phoenix that we are not gonna touch.

**coveralls.json**

```
  {
    "skip_files": [
      "lib/casting_vote_web.ex",
      "lib/casting_vote.ex",
      "lib/casting_vote/application.ex",
      "lib/casting_vote/mailer.ex",
      "lib/casting_vote/repo.ex.ex",
      "lib/casting_vote_web/telemetry.ex",
      "lib/casting_vote_web/gettext.ex",
      "lib/casting_vote_web/views/error_helpers.ex",
      "test/support/conn_case.ex",
      "test/support/data_case.ex"
    ]
  }
```

**router.ex**

Use comments **# coveralls-ignore-start** and **# coveralls-ignore-stop** in router file to ignore LiveDashboard and Swoosh mailbox preview from code coverage calculation.
Put pipeline :api in the comment as well.

## Installing Tailwind CSS

Follow instructions from [Install Tailwind CSS with Phoenix](https://tailwindcss.com/docs/guides/phoenix).

## Adding fonts

**layout/root.html.heex**

```
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@400;600;700&display=swap" rel="stylesheet">
```

**tailwind.config.js**

```
  const defaultTheme = require("tailwindcss/defaultTheme");

  theme: {
    extend: {
      fontFamily: {
        sans: ["League Spartan", ...defaultTheme.fontFamily.sans],
      },
    },
    screens: {
      xs: "375px",
      s: "480px",
      sm: "640px",
      md: "768px",
      lg: "896px",
      xl: "1024px",
      "2xl": "1280px",
      "4xl": "1536px",
    },
  },
```

## Clean up generated boilerplate code. Fix the failing test.

## Commit to github

```
  git commit -m "Added credo, excoveralls, mix_test_watch, tailwind and different font. Cleaned up boilerplate."
```
